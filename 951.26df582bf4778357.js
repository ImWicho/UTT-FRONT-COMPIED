"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[951],{3951:(it,T,r)=>{r.r(T),r.d(T,{DocModule:()=>et});var p=r(9808),A=r(2302),Z=r(655),v=r(6087),U=r(4847),c=r(6346),d=r(7991),s=r(3075),u=r(8966),t=r(5e3),D=r(3628),_=r(7161),m=r(7322),C=r(7531),f=r(6856),x=r(9814),q=r(7423);let I=(()=>{class o{constructor(e,n,a,l,h){this.fb=e,this.service=n,this.dialog=a,this.notificationService=l,this.data=h,this.isLoading=!1,this.buildForm()}ngOnInit(){this.data&&(console.log(this.data),this.form.patchValue(Object.assign(Object.assign({},this.data),{documentosRelacionados:this.data.documentos_relacionados,tipoResguardo:this.data.tipo_resguardo,disposicionFinal:this.data.disposicion_final})))}sendData(){var e;if(this.form.invalid)return;this.isLoading=!0;const n=Object.assign(Object.assign({},this.form.value),{conservacion:new p.uU("en").transform(null===(e=this.form.get("conservacion"))||void 0===e?void 0:e.value,"YYYY-MM-dd")});this.data?this.service.onUpdateDocument(Object.assign(Object.assign({},n),{id:this.data.id})).subscribe(a=>{this.notificationService.onShowNotification({title:"Documento actualizado",desc:"El documento se ha actualizado correctamente.",type:d.d.SUCCESS}),this.dialog.close(!0)},a=>{this.isLoading=!1,this.notificationService.onShowNotification({title:"Ocurri\xf3 un error",desc:"Intente m\xe1s tarde o contacte a soporte.",type:d.d.DANGER})}):this.service.onSaveDocument(n).subscribe(a=>{this.notificationService.onShowNotification({title:"Documento creado",desc:"El documento se ha creado correctamente.",type:d.d.SUCCESS}),this.dialog.close(!0)},a=>{this.isLoading=!1,this.notificationService.onShowNotification({title:"Ocurri\xf3 un error",desc:"Intente m\xe1s tarde o contacte a soporte.",type:d.d.DANGER})})}buildForm(){this.form=this.fb.group({nombre:[null,[s.kI.required]],tipo:[null,[s.kI.required]],version:[null,[s.kI.required]],responsable:[null,[s.kI.required]],areas:[null,[s.kI.required]],documentosRelacionados:[null,[s.kI.required]],sustituye:[null,[s.kI.required]],codigo:[null,[s.kI.required]],conservacion:[null,[s.kI.required]],tipoResguardo:[null,[s.kI.required]],disposicionFinal:[null,[s.kI.required]]})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(s.qu),t.Y36(D.R),t.Y36(u.so),t.Y36(_.g),t.Y36(u.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-doc-dialog"]],decls:71,vars:9,consts:[["mat-dialog-title",""],[1,"mat-typography"],[3,"formGroup"],[1,"row"],[1,"col-xs-12","col-sm-12","col-md-6","col-lg-6"],["appearance","outline"],["matInput","","placeholder","Nombre","formControlName","nombre"],["matInput","","placeholder","Tipo","formControlName","tipo"],["matInput","","placeholder","Version","formControlName","version"],["matInput","","placeholder","Responsable","formControlName","responsable"],["matInput","","placeholder","Areas","formControlName","areas"],["matInput","","placeholder","Documentos relacionados","formControlName","documentosRelacionados"],["matInput","","placeholder","C\xf3digo","formControlName","codigo"],["matInput","","formControlName","conservacion","readonly","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","placeholder","Tipo resguardo","formControlName","tipoResguardo"],["matInput","","placeholder","Disposici\xf3n","formControlName","disposicionFinal"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],["formControlName","sustituye"],["color","primary",3,"value"],["color","primary",2,"margin-left","10px",3,"value"],["align","end"],["mat-flat-button","",3,"mat-dialog-close"],["mat-flat-button","","color","primary",3,"disabled","click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Crear documento"),t.qZA(),t.TgZ(2,"mat-dialog-content",1),t.TgZ(3,"form",2),t.TgZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"mat-form-field",5),t.TgZ(7,"mat-label"),t._uU(8,"Nombre"),t.qZA(),t._UZ(9,"input",6),t.qZA(),t.qZA(),t.TgZ(10,"div",4),t.TgZ(11,"mat-form-field",5),t.TgZ(12,"mat-label"),t._uU(13,"Tipo"),t.qZA(),t._UZ(14,"input",7),t.qZA(),t.qZA(),t.TgZ(15,"div",4),t.TgZ(16,"mat-form-field",5),t.TgZ(17,"mat-label"),t._uU(18,"Version"),t.qZA(),t._UZ(19,"input",8),t.qZA(),t.qZA(),t.TgZ(20,"div",4),t.TgZ(21,"mat-form-field",5),t.TgZ(22,"mat-label"),t._uU(23,"Responsable"),t.qZA(),t._UZ(24,"input",9),t.qZA(),t.qZA(),t.TgZ(25,"div",4),t.TgZ(26,"mat-form-field",5),t.TgZ(27,"mat-label"),t._uU(28,"Areas"),t.qZA(),t._UZ(29,"input",10),t.qZA(),t.qZA(),t.TgZ(30,"div",4),t.TgZ(31,"mat-form-field",5),t.TgZ(32,"mat-label"),t._uU(33,"Documentos relacionados"),t.qZA(),t._UZ(34,"input",11),t.qZA(),t.qZA(),t.TgZ(35,"div",4),t.TgZ(36,"mat-form-field",5),t.TgZ(37,"mat-label"),t._uU(38,"C\xf3digo"),t.qZA(),t._UZ(39,"input",12),t.qZA(),t.qZA(),t.TgZ(40,"div",4),t.TgZ(41,"mat-form-field",5),t.TgZ(42,"mat-label"),t._uU(43,"Conservaci\xf3n"),t.qZA(),t._UZ(44,"input",13),t._UZ(45,"mat-datepicker-toggle",14),t._UZ(46,"mat-datepicker",null,15),t.qZA(),t.qZA(),t.TgZ(48,"div",4),t.TgZ(49,"mat-form-field",5),t.TgZ(50,"mat-label"),t._uU(51,"Tipo resguardo"),t.qZA(),t._UZ(52,"input",16),t.qZA(),t.qZA(),t.TgZ(53,"div",4),t.TgZ(54,"mat-form-field",5),t.TgZ(55,"mat-label"),t._uU(56,"Disposici\xf3n"),t.qZA(),t._UZ(57,"input",17),t.qZA(),t.qZA(),t.TgZ(58,"div",18),t.TgZ(59,"p"),t._uU(60,"Sustituye: "),t.qZA(),t.TgZ(61,"mat-radio-group",19),t.TgZ(62,"mat-radio-button",20),t._uU(63,"Si"),t.qZA(),t.TgZ(64,"mat-radio-button",21),t._uU(65,"No"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(66,"mat-dialog-actions",22),t.TgZ(67,"button",23),t._uU(68,"Cancelar"),t.qZA(),t.TgZ(69,"button",24),t.NdJ("click",function(){return n.sendData()}),t._uU(70," Aceptar "),t.qZA(),t.qZA()),2&e){const a=t.MAs(47);t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(41),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(17),t.Q6J("value",!0),t.xp6(2),t.Q6J("value",!1),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.ekj("spinner",n.isLoading),t.Q6J("disabled",n.form.invalid||n.isLoading)}},directives:[u.uh,u.xY,s._Y,s.JL,s.sg,m.KE,m.hX,C.Nt,s.Fj,s.JJ,s.u,f.hl,f.nW,m.R9,f.Mq,x.VQ,x.U0,u.H8,q.lW,u.ZT],styles:[""]}),o})();var b=r(6155),N=r(6727),S=r(5245),g=r(2531);function y(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," ID "),t.qZA())}function Y(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e.id," ")}}function R(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," NOMBRE "),t.qZA())}function w(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.nombre)," ")}}function E(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," RESPONSABLE "),t.qZA())}function Q(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.responsable)," ")}}function O(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," RESGUARDO "),t.qZA())}function k(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.tipo_resguardo)," ")}}function J(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," AREA "),t.qZA())}function G(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.areas)," ")}}function M(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," CODIGO "),t.qZA())}function j(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.codigo)," ")}}function F(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," VERSION "),t.qZA())}function B(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.version)," ")}}function L(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," ESTATUS "),t.qZA())}function $(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ","pendient"===e.status?"PENDIENTE":"APROBADO"," ")}}function z(o,i){1&o&&(t.TgZ(0,"th",28),t._uU(1," OPCIONES "),t.qZA())}function H(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",29),t.TgZ(1,"button",30),t._UZ(2,"mat-icon",31),t.qZA(),t.TgZ(3,"mat-menu",null,32),t.TgZ(5,"button",33),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().updateStatus(l)}),t._UZ(6,"mat-icon",34),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.TgZ(9,"button",33),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().openDialogEdit(l)}),t._UZ(10,"mat-icon",35),t.TgZ(11,"span"),t._uU(12,"Editar"),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=i.$implicit,n=t.MAs(4),a=t.oxw();t.xp6(1),t.Q6J("matMenuTriggerFor",n),t.xp6(4),t.Q6J("disabled","2"===(null==a.user?null:a.user.role_id)||"4"===(null==a.user?null:a.user.role_id)),t.xp6(3),t.Oqu("pendient"===e.status?"Aprobar documento":"Cambiar a pendiente"),t.xp6(1),t.Q6J("disabled","2"===(null==a.user?null:a.user.role_id)||"4"===(null==a.user?null:a.user.role_id))}}function P(o,i){1&o&&t._UZ(0,"tr",36)}function V(o,i){1&o&&t._UZ(0,"tr",37)}function W(o,i){if(1&o&&(t.TgZ(0,"tr",38),t.TgZ(1,"td",39),t._uU(2),t.qZA(),t.qZA()),2&o){t.oxw();const e=t.MAs(16);t.xp6(2),t.hij('No se encontraron registros "',e.value,'"')}}const X=function(){return[10,25,100]},K=[{path:"",component:(()=>{class o{constructor(e,n,a,l){this.service=e,this.dialogService=n,this.store=a,this.notificationService=l,this.displayedColumns=["id","nombre","responsable","tipo_resguardo","areas","codigo","version","status","options"],this.docs=[]}ngOnInit(){this.onGetDocs(),this.subs=this.store.select("user").subscribe(e=>this.user=e.user)}ngOnDestroy(){this.subs.unsubscribe()}openDialog(){return(0,Z.mG)(this,void 0,void 0,function*(){(yield this.dialogService.onShowDialog(I,{width:800}).toPromise())&&this.onGetDocs()})}openDialogEdit(e){return(0,Z.mG)(this,void 0,void 0,function*(){(yield this.dialogService.onShowDialogData(I,e,{width:800}).toPromise())&&this.onGetDocs()})}updateStatus(e){return(0,Z.mG)(this,void 0,void 0,function*(){(yield this.dialogService.onShowConfirmation({title:"\xbfEst\xe1s seguro de aprovar el documento?",desc:"El documento cambiar\xe1 a Aprovado",icon:"alert-circle-outline"}).toPromise())&&this.service.onUpdateDocumentStatus({docId:e.id,status:"pendient"===e.status?"approved":"pendient"}).subscribe(n=>{this.onGetDocs(),this.notificationService.onShowNotification({title:"Documento actualizado",desc:"El documento se ha actualizado correctamente.",type:d.d.SUCCESS})},n=>{this.notificationService.onShowNotification({title:"Ocurri\xf3 un error",desc:"Intente m\xe1s tarde o contacte a soporte.",type:d.d.DANGER})})})}onGetDocs(){this.service.onGetDocuments().subscribe(e=>{this.docs=e,this.setData()})}setData(){this.dataSource=new c.by,this.dataSource.data=this.docs,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}applyFilter(e){this.dataSource.filter=e.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D.R),t.Y36(b.x),t.Y36(N.yh),t.Y36(_.g))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-doc-index"]],viewQuery:function(e,n){if(1&e&&(t.Gf(v.NW,5),t.Gf(U.YE,5)),2&e){let a;t.iGM(a=t.CRH())&&(n.paginator=a.first),t.iGM(a=t.CRH())&&(n.sort=a.first)}},decls:52,vars:6,consts:[[1,"container-fluid"],[1,"row"],[1,"col-xs-12","col-sm-12","col-md-12","col-lg-12"],[1,"col-xs-12","col-sm-12","col-md-6","col-lg-6","row","middle-xs","between-xs"],["mat-flat-button","","color","primary",3,"disabled","click"],["mat-icon-button","",3,"click"],["svgIcon","refresh"],[1,"col-xs-12","col-sm-12","col-md-6","col-lg-6"],["appearance","standard"],["matInput","","placeholder","Ex. Sistemas",3,"keyup"],["input",""],[1,"table-responsive"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","responsable"],["matColumnDef","tipo_resguardo"],["matColumnDef","areas"],["matColumnDef","codigo"],["matColumnDef","version"],["matColumnDef","status"],["matColumnDef","options"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of docs",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-icon-button","",3,"matMenuTriggerFor"],["svgIcon","dots-vertical"],["menu","matMenu"],["mat-menu-item","",3,"disabled","click"],["svgIcon","file-refresh"],["svgIcon","pencil"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"h2"),t._uU(4,"Documentos"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(5,"div",1),t.TgZ(6,"div",3),t.TgZ(7,"button",4),t.NdJ("click",function(){return n.openDialog()}),t._uU(8,"Crear documento"),t.qZA(),t.TgZ(9,"button",5),t.NdJ("click",function(){return n.onGetDocs()}),t._UZ(10,"mat-icon",6),t.qZA(),t.qZA(),t.TgZ(11,"div",7),t.TgZ(12,"mat-form-field",8),t.TgZ(13,"mat-label"),t._uU(14,"Buscar"),t.qZA(),t.TgZ(15,"input",9,10),t.NdJ("keyup",function(l){return n.applyFilter(l)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",1),t.TgZ(18,"div",2),t.TgZ(19,"div",11),t.TgZ(20,"table",12),t.ynx(21,13),t.YNc(22,y,2,0,"th",14),t.YNc(23,Y,2,1,"td",15),t.BQk(),t.ynx(24,16),t.YNc(25,R,2,0,"th",14),t.YNc(26,w,3,3,"td",15),t.BQk(),t.ynx(27,17),t.YNc(28,E,2,0,"th",14),t.YNc(29,Q,3,3,"td",15),t.BQk(),t.ynx(30,18),t.YNc(31,O,2,0,"th",14),t.YNc(32,k,3,3,"td",15),t.BQk(),t.ynx(33,19),t.YNc(34,J,2,0,"th",14),t.YNc(35,G,3,3,"td",15),t.BQk(),t.ynx(36,20),t.YNc(37,M,2,0,"th",14),t.YNc(38,j,3,3,"td",15),t.BQk(),t.ynx(39,21),t.YNc(40,F,2,0,"th",14),t.YNc(41,B,3,3,"td",15),t.BQk(),t.ynx(42,22),t.YNc(43,L,2,0,"th",14),t.YNc(44,$,2,1,"td",15),t.BQk(),t.ynx(45,23),t.YNc(46,z,2,0,"th",14),t.YNc(47,H,13,4,"td",15),t.BQk(),t.YNc(48,P,1,0,"tr",24),t.YNc(49,V,1,0,"tr",25),t.YNc(50,W,3,1,"tr",26),t.qZA(),t.qZA(),t._UZ(51,"mat-paginator",27),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(7),t.Q6J("disabled","2"===(null==n.user?null:n.user.role_id)||"4"===(null==n.user?null:n.user.role_id)),t.xp6(13),t.Q6J("dataSource",n.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(5,X)))},directives:[q.lW,S.Hw,m.KE,m.hX,C.Nt,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,c.Ee,v.NW,c.ge,c.ev,g.p6,g.VK,g.OP,c.XQ,c.Gk],pipes:[p.gd],styles:[""]}),o})()}];let tt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[A.Bz.forChild(K)],A.Bz]}),o})();var ot=r(9336);let et=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[p.ez,tt,ot.q,s.UX]]}),o})()}}]);